<!DOCTYPE html>
<html><head>
  <meta charset="utf-8"> 
  <title>Touchauth Demo</title>
  <script src="http://gimite.net/js/jquery-1.3.2.min.js"></script>
  <script>
    
    if (!window.console) {
      window.console = {log: function() { }, error: function() { }};
    }
    
  </script>
</head><body>

<h1>Touchauth Demo</h1>

<% if @user %>
  
  <p>Hello <b><%=h @user.id %></b>! You have logged in.</p>
  
  <p>Please try to log out and log in again. Second time log-in on the same PC/browser is easier: just one touch on your phone.</p>
  
  <form action="/expire_session" method="POST">
    <input type="submit" value="Log out"/>
  </form>

<% else %>
  
  <p>This is a demo site of Touchauth, which enables you to log in by your mobile phone instead of password.</p>
  
  <p>Steps to try Touchauth:</p>
  
  <ol>
    <li>Check [Application]->[Unknown sources] in settings in your Android phone.</li>
    <li>
      Install <a href="<%=h @apk_url %>">Touchauth Android app</a> and sign up in the app.<br/>
      <img src="<%=h @apk_qr_url %>"/>
    </li>
    <li>Click Log-in button below.</li>
  </ol>
  
  <% if @browser %>
    
    <form action="/login" method="POST">
      <input type="submit" value="Log in as <%=h @browser.user_id %>"/>
      ← Log in by touch
    </form>
    <form action="/login" method="POST">
      <input type="hidden" name="type" value="qr"/>
      <input type="submit" value="Log in as someone else"/>
      ← Log in by QR code
    </form>
    
  <% else %>
    
    <form action="/login" method="POST">
      <input type="submit" value="Log in"/>
    </form>
    
  <% end %>
  
<% end %>

</body></html>
